
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>front page</title>
    </head>
    <body>
        <script>
            function requestsend()
            {
                var form = new FormData(document.getElementById('form'));
                var obj = {"name":form.get("name"), "rollno":form.get("rollno"), "email":form.get("emailID"), "phno":form.get("phone"), 
                            "university":form.get("university"), "CGPA":form.get("cgpa"), "passkey":form.get("passkey")};

                var JSONdata = JSON.stringify(obj);

                var xhr = new XMLHttpRequest();
                xhr.open("POST", "http://54.152.156.84:5000/addStudent", true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function(){
                    if (xhr.status === 201)     //&& xhr.readyState === 4)
                    {
                        var myObj = JSON.parse(this.responseText);
                        sessionStorage.setItem("student_id", myObj["user_id"]);
                        sessionStorage.setItem("contest_id", form.get("passkey"));
                        alert("Student added");
                        window.location.href = "test.html";
                    }
                        
                    else
                        alert("Student exists");
                };
                xhr.send(JSONdata);
                alert("Processing");
            }
        </script>
        <form id='form'  onsubmit="requestsend()" method="POST">
            Name: <input type="text" name="name">
            <br>
            Rollno: <input type="text" name="rollno">
            <br>
            Email: <input type="email" name="emailID">
            <br>
            Phno: <input type="text" name="phone" maxlength="10">
            <br>
            University: <input type="text" name="university">
            <br>
            CGPA: <input type="number" step="0.01" name="cgpa" max="10">
            <br>
            Passkey: <input type="text" name="passkey" max="10">
            <br>
            <input type="submit" value="Submit">
        </form>
    </body>
</html>